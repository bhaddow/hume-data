
#!/usr/bin/env python
from __future__ import print_function, division

import sys, string
import pandas
import numpy
from  pandas_confusion import ConfusionMatrix
import extract_sentences_for_WMT_metrics_task


SCORE_TYPES = ['all','atomic','struct','P','S','C','H','E','A','L']
LANGS = ['ro','de','cs','pl']
LANGS = ['de','ro']

prefix="data/wmtmetrics/himl2015"

DAsents ={}
DAsents['ro'] = [641, 711, 639, 195, 575, 11, 721, 659, 101, 785, 625, 687, 213, 291, 729, 381, 435, 185, 375, 45, 485, 63, 611, 457, 59, 405, 1, 47, 767, 401, 31, 233, 647, 475, 391, 737, 327, 449, 469, 169, 299, 257, 17, 689, 129, 395, 263, 289, 145, 617, 349, 249, 369, 357, 131, 555, 55, 559, 43, 345, 419, 561, 265, 79, 201, 223, 759, 261, 171, 339, 459, 217, 583, 733, 465, 331, 619, 663, 749, 677, 651, 675, 727, 609, 313, 589, 67, 603, 507, 207, 231, 85, 247, 597, 719, 649, 461, 593, 65, 613, 97, 139, 443, 761, 633, 367, 199, 541, 297, 567, 177, 411, 181, 203, 255, 753, 743, 635, 545, 359, 205, 445, 489, 135, 713, 717, 229, 535, 127, 91, 509, 661, 83, 599, 585, 173, 227, 73, 513, 483, 453, 269, 377, 493, 107, 159, 373, 533, 325, 491, 517, 577, 521, 329, 9, 655, 347, 383, 403, 117, 573, 81, 765, 311, 783, 49, 211, 735, 219, 23, 275, 307, 75, 397, 701, 143, 547, 183, 571, 433, 549, 303, 187, 113, 605, 165, 19, 155, 321, 429, 225, 631, 95, 133, 189, 607, 121, 251, 793, 591, 241, 441, 273, 193, 341, 315, 209, 421, 563, 27, 167, 741, 285, 543, 769, 115, 531, 703, 109, 499, 335, 601, 351, 277, 681, 309, 243, 473, 515, 35, 51, 437, 645, 179, 197, 683, 137, 775, 467, 175, 37, 301, 705, 99, 385, 725, 279, 671, 271, 337, 799, 237, 21, 71, 667, 149]
DAsents['de'] = [641, 711, 639, 195, 575, 11, 721, 659, 101, 785, 625, 687, 213, 291, 729, 381, 435, 185, 375, 45, 485, 63, 611, 457, 59, 405, 1, 47, 767, 401, 31, 233, 647, 475, 391, 737, 327, 449, 469, 169, 299, 257, 17, 689, 129, 395, 263, 289, 145, 617, 349, 249, 369, 357, 131, 555, 55, 559, 43, 345, 419, 561, 265, 79, 201, 223, 759, 261, 171, 339, 459, 217, 583, 733, 465, 331, 619, 663, 749, 677, 651, 675, 727, 609, 313, 589, 67, 603, 507, 207, 231, 85, 247, 597, 719, 649, 461, 593, 65, 613, 97, 139, 443, 761, 633, 367, 199, 541, 297, 567, 177, 411, 181, 203, 255, 753, 743, 635, 545, 359, 205, 445, 489, 135, 713, 717, 229, 535, 127, 91, 509, 661, 83, 599, 585, 173, 227, 73, 513, 483, 453, 269, 377, 493, 107, 159, 373, 533, 325, 491, 517, 577, 521, 329, 9, 655, 347, 383, 403, 117, 573, 81, 765, 311, 783, 49, 211, 735, 219, 23, 275, 307, 75, 397, 701, 143, 547, 183, 571, 433, 549, 303, 187, 113, 605, 165, 19, 155, 321, 429, 225, 631, 95, 133, 189, 607, 121, 251, 793, 591, 241, 441, 273, 193, 341, 315, 209, 421, 563, 27, 167, 741, 285, 543, 769, 115, 531, 703, 109, 499, 335, 601, 351, 277, 681, 309, 243, 473, 515, 35, 51, 437, 645, 179, 197, 683, 137, 775, 467, 175, 37, 301, 705, 99, 385, 725, 279, 671, 271, 337, 799, 237, 21, 71, 667, 149]

numstot = {}
def main():
  nodedata = pandas.read_csv("nodes.csv", converters={'node_id': str, 'parent' : str})

  for lang in LANGS:
    data = nodedata.loc[nodedata["lang"] == lang]
    numslang = {}

    for score_type in extract_sentences_for_WMT_metrics_task.SCORE_TYPES:
      numslang[score_type] = 0

    for id in DAsents[lang]:
      datasent = data.loc[data["sent_id"] == id]

      for score_type in extract_sentences_for_WMT_metrics_task.SCORE_TYPES:

        if (score_type == 'all'):
          datacurr = datasent
        elif (score_type == 'atomic'):
          datacurr = datasent.loc[(data["mt_label"] == "G")|(data["mt_label"] == "R")|(data["mt_label"] == "O")]
        elif (score_type == 'struct'):
          datacurr = datasent.loc[ (data["mt_label"] == "A")|(data["mt_label"] == "B") ]
        else:
          datacurr = datasent.loc[(data["ucca_label"] == score_type) ]

        numslang[score_type] += datacurr['sent_id'].size
    numstot[lang] = numslang     

  print (numstot)



if __name__ == "__main__":
  main()

